<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- bootstrap 사용 하기 위한 link -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">

    <!-- google material icons 사용하기 위한 link 추가 -->

    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>


    <!-- js query를 사용 하기 위한 script 추가 -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>


    <title> 회원 가입 페이지 </title>
</head>
<body style="background-color: #FAFAFA">
    <div style="display :flex ;flex-direction: column ; justify-content: center ; align-items:center; width : 100%">
        <div style="padding :20px ; text-align:center ; border : solid 1px rgba(200,200,200, 1); width :300px; height:500px ; margin-top : 30px; background:white">
            <div style = "padding-bottom: 20px"><img style="width : 50px"
                                              src="https://cdn.pixabay.com/photo/2015/04/08/15/09/daisies-712892_1280.jpg"/>
            </div>
            <div style = "padding-bottom: 20px ; font-weight: bold">친구들의 사진과 동영상을 보려면 가입 하세요</div>
            <div class="form-floating mb-2 floating_form">
                <input type="email" class="floating_input form-control" id="floatingEmail"
                       placeholder="name@example.com">
                <label for="floatingEmail" class="floating_label">이메일 주소</label>
            </div>
            <div class="form-floating mb-2 floating_form">
                <input type="email" class="floating_input form-control" id="floatingName"
                       placeholder="name">
                <label for="floatingName" class="floating_label">이름</label>
            </div>
            <div class="form-floating mb-2 floating_form">
                <input type="email" class="floating_input form-control" id="floatingNickname"
                       placeholder="nickname">
                <label for="floatingNickname" class="floating_label">닉네임</label>
            </div>
            <div class="form-floating mb-2 floating_form">
                <input type="email" class="floating_input form-control" id="floatingPassword"
                       placeholder="password">
                <label for="floatingPassword" class="floating_label">패스워드</label>
            </div>

            <button id = "join_button" style = "width : 100%" type="button" class="btn btn-primary"> 가입 버튼</button>
        </div>

        <div style="padding :20px ; text-align:center ; border : solid 1px rgba(200,200,200, 1); width :300px; height:100px ; margin-top : 30px; background:white">
            <div>계정이 있으신가요 ? <a href = "{% url 'login' %}">로그인</a></div>
        </div>
   </div>

<!-- Optional JavaScript; choose one of the two! -->
<script>
    $('#join_button').on('click',()=>{
        let email = $('#floatingEmail').val();
        let name = $('#floatingName').val();
        let nickname = $('#floatingNickname').val();
        let password = $('#floatingPassword').val();
        console.log('이멜 :' + email + ', 이름 :'  + name + ', 사용자이름 :'  +  nickname + ', 비밀번호 :'  +  password);

        $.ajax({
            url: "/user/join",
            data: {
                email: email,
                password: password,
                nickname: nickname,
                name: name,
                csrfmiddlewaretoken: '{{ csrf_token }}'
            },
            method: "POST",
            dataType: "json",
            success: function (response) {
                alert(response.message);
                // 성공 시 로그인 페이지로 이동
                window.location.replace("{% url 'user:login' %}"); // 앱 이름을 포함한 URL 사용 권장
            },
            error:function (request, status, error){
                let data = JSON.parse(request.responseText);
                alert(data.message);
            },
            complete: function () {
            }
        });

    });
</script>












<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.min.js"
        integrity="sha384-7qAoOXltbVP82dhxHAUje59V5r2YsVfBafyUDxEdApLPmcdhBPg1DKg1ERo0BZlK"
        crossorigin="anonymous"></script>



</body>
</html>